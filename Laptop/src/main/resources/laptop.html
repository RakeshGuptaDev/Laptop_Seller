<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=\, initial-scale=1.0">
    <title>LaptopApp</title>
    <style>
        *{
            font-weight: 500;
            font-size: 15px;
            font-family: Arial, Helvetica, sans-serif;
        }
        button{
            border-radius: 8px;
            border-color: black;
            font-size: 16px;
            font-weight: 600;
        }
        button:hover{
            color: lawngreen;
            background-color: black;
            
        }
        input{
            border-radius: 8px;
        }
        #body {
            margin-top: 50px;
            display: flex;
            justify-content: center;
            flex-direction: column;
            align-items: center;
            background-color: rgb(155, 155, 155);
            padding: 20px;
            border-radius: 15px;
            border: 2px solid black;
        }
        #main{
            display: flex; 
            justify-content: center;
        }
        div{
            margin-top: 10px;
        }
        #table{
            margin-left: auto;
            margin-right: auto;
            border: 2px solid black;
            border-radius: 8px;
            color: black;
            font-size: 20px;
        }
        .val{
            font-size: 20px;     
            font-weight: 500;
            padding: 8px;
            border: 1px solid;
        }
        th{
            padding: 8px;
            font-size: 20px;  
            font-weight: bold;
        }
        

    
    </style>
</head>

<body>
    <div id="main">
    <div id="body">
        <div>
            <table id="form">
                <tr>
                    <td>Id</td>
                    <td>: <input type="text" id="id"></td>
                </tr>
                <tr>
                    <td>Name </td>
                    <td>: <input type="text" id="name"></td>
                </tr>
                <tr>
                    <td>Ram </td>
                    <td>: <input type="text" id="ram"></td>
                </tr>
                <tr>
                    <td>OS </td>
                    <td>: <input type="text" id="os"></td>
                </tr>
                <tr>
                    <td>WebCam </td>
                    <td>: <input type="text" id="webcam"></td>
                </tr>
                <tr>
                    <td>Price </td>
                    <td>: <input type="text" id="price"></td>
                </tr>
            </table>
        </div>
        <div><button type="submit" id="save" onclick="sendPost()">Save</button> <button type="submit" id="update"
                onclick="sendPut()">Update</button></div>
        <div><button type="submit" onclick="sendDelete()">Delete</button> : <input type="text" id="delete"
                placeholder="Enter Laptop id to Delete"></div>
        <div><button type="submit" onclick="searchId()">Search</button> : <input type="text" id="Sid"
                placeholder="Search By ID"></div>
        <div><button type="submit" onclick="searchName()">Search</button> : <input type="text" id="Sname"
                placeholder="Search By Name"></div>
        <div><button type="submit" onclick="searchOs()">Search</button> : <input type="text" id="Sos"
                placeholder="Search By Os"></div>
        <div><button type="submit" onclick="searchPrice()">Search</button> : <input type="text" id="Sprice"
                placeholder="Search By Price"></div>
        <div><button type="submit" onclick="searchRam()">Search</button> : <input type="text" id="Sram"
                placeholder="Search By Ram"></div>
        <div><button type="submit" onclick="searchWebcam()">Search</button> : <input type="text" id="Swebcam"
                placeholder="Search By WebCam"></div>
        <div id="findAll"><button type="submit" onclick="getData()">Show All Records</button></div>
    </div>
    </div>
    <br><br>
    <div>

    </div>
    <table id="table">
    </table>

    <script>

        
        function searchWebcam() {
            webcam = document.getElementById('Swebcam').value;
            url = "http://localhost:8091/laptop/webcam/" + webcam;
            fetch(url).then((response) => {
                // console.log("inside  J ");
                return response.json();
            }).then((data) => {
                // 
                showAll(data);
                console.log(data);
            });
        }


        function searchPrice() {
            price = document.getElementById('Sprice').value;
            url = "http://localhost:8091/laptop/price/" + price;
           
            fetch(url).then((response) => {
                // console.log("inside  J ");
                return response.json();
            }).then((data) => {
                // 
                console.log("In price :  ") 
                console.log(data);
                showAll(data);
            });
        }

        function searchRam() {
            ram = document.getElementById('Sram').value;
            url = "http://localhost:8091/laptop/ramAvailable/" + ram;
            fetch(url).then((response) => {
                // console.log("inside  J ");
                return response.json();
            }).then((data) => {
                // 
                showAll(data);
                console.log(data);
            });
        }

        function searchOs() {
            name = document.getElementById('Sos').value;
            url = "http://localhost:8091/laptop/osName/" + name;
            fetch(url).then((response) => {
                // console.log("inside  J ");
                return response.json();
            }).then((data) => {
                // 
                showAll(data);
                console.log(data);
            });
        }


        function searchName() {
            name = document.getElementById('Sname').value;
            url = "http://localhost:8091/laptop/name/" + name;
            fetch(url).then((response) => {
                // console.log("inside  J ");
                return response.json();
            }).then((data) => {
                // 
                showAll(data);
                console.log(data);
            });
        }



        function searchId() {
            id = document.getElementById('Sid').value;
            url = "http://localhost:8091/laptop/" + id;
            fetch(url).then((response) => {
                console.log("ID  :  ");
                console.log(response);
                return response.json();
            }).then((data) => {
                console.log(data);
                data = [data];
                showAll(data);
            });
        }

        //Display All
        function showAll(data) {
            if(data.errorMessage!=null){
                document.getElementById('table').innerHTML= data.errorMessage;
                return;
            }
            
            content = "<tr><th class='val'>ID</th><th class='val'>Name</th><th class='val'>Ram</th><th class='val'>OS</th><th class='val'>WebCam</th><th class='val'>Price</th></tr>";
            
            for (i = 0; i < data.length; i++) {
                content += "<tr><td class='val'>" + data[i].id + "</td>";
                content += "<td class='val'>" + data[i].name + "</td>";
                content += "<td class='val'>" + data[i].ramAvailable + "</td>";
                content += "<td class='val'>" + data[i].osName + "</td>";
                content += "<td class='val'>" + data[i].webcam + "</td>";
                content += "<td class='val'>" + data[i].price + "</td></tr>";
            }
            document.getElementById('table').innerHTML = content;
        }

        function getData() {
            url = "http://localhost:8091/laptop";
            fetch(url).then((response) => {
                // console.log("inside  J ");
                console.log(response);
                return response.json();
            }).then((data) => {
                // 
                showAll(data);
                console.log(data);
            });
        }


        //Deleting laptop
        function sendDelete() {
            var id = document.getElementById("delete").value;
            if(Number.isInteger(id)==false){
                document.getElementById('table').innerHTML="Enter valid Input!";
                return;
            }
            laptop = createLaptop();
            url = "http://localhost:8091/laptop/" + id;
            var req = new XMLHttpRequest();
            req.open("DELETE", url);
            req.setRequestHeader("Content-Type", "application/json");
            req.send(laptop);
        }

        //Updating laptop
        function sendPut() {
            laptop = createLaptop();
            var id = laptop.id;
            var url = "http://localhost:8091/laptop/" + id;
            var msg = JSON.stringify(laptop);
            var req = new XMLHttpRequest();
            req.open("PUT", url);
            req.setRequestHeader("Content-Type", "application/json");
            req.send(msg);
        }

        //Sending Post Request
        function sendPost() {
            
            laptop = createLaptop();
            var url = "http://localhost:8091/laptop";
            var msg = JSON.stringify(laptop);
            var req = new XMLHttpRequest();
            req.open("POST", url);
            req.setRequestHeader("Content-Type", "application/json");
            req.send(msg);
        }

        //Creating laptop object
        function createLaptop() {
            var id = document.getElementById('id').value;
            var name = document.getElementById('name').value;
            var ram = document.getElementById('ram').value;
            var os = document.getElementById('os').value;
            var webcam = document.getElementById('webcam').value;
            var price = document.getElementById('price').value;
            laptop = {
                "id": id, "name": name,
                "ramAvailable": ram, "osName": os, "webcam": webcam, "price": price
            }
            return laptop;
        }
    </script>
</body>

</html>